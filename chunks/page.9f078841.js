function d(e){e=e||1;var t=[],n=0;function o(c){t.push(c)>1||r()}function a(){n--,r()}function r(){n<e&&t.length>0&&(t.shift()(),n++)}return[o,a]}function m(e,t){const n=t?.timeout??50,o=Date.now();return setTimeout(function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,n-(Date.now()-o))}})},1)}const v=window.requestIdleCallback||m;var w=v;const f=["mouseenter","touchstart","focus"],u=new Set;function p({href:e}){try{const t=new URL(e);return window.location.origin===t.origin&&window.location.pathname!==t.hash&&!u.has(e)}catch{}return!1}let i,s;function b(e){u.add(e.href),s.observe(e),f.map(t=>e.addEventListener(t,l,{once:!0}))}function y(e){s.unobserve(e),f.map(t=>e.removeEventListener(t,l))}function l({target:e}){e instanceof HTMLAnchorElement&&h(e)}async function h(e){y(e);const{href:t}=e;try{const n=await fetch(t).then(r=>r.text());i=i||new DOMParser;const o=i.parseFromString(n,"text/html"),a=Array.from(o.querySelectorAll('link[rel="stylesheet"]'));await Promise.all(a.map(r=>fetch(r.href)))}catch{}}function g({selector:e='a[href][rel~="prefetch"]',throttle:t=1}){const n=navigator.connection;if(typeof n<"u"){if(n.saveData)return Promise.reject(new Error("Cannot prefetch, Save-Data is enabled"));if(/2g/.test(n.effectiveType))return Promise.reject(new Error("Cannot prefetch, network conditions are poor"))}const[o,a]=d(t);s=s||new IntersectionObserver(r=>{r.forEach(c=>{c.isIntersecting&&c.target instanceof HTMLAnchorElement&&o(()=>h(c.target).finally(a))})}),w(()=>{const r=Array.from(document.querySelectorAll(e)).filter(p);for(const c of r)b(c)})}g({});
